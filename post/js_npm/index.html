<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPM - Morgoth</title>
    <meta name="description" content="">
    
    
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: #fff;
            padding: 1rem 0;
            border-bottom: 1px solid #ddd;
            margin-bottom: 2rem;
        }
        nav {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        nav a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
        }
        nav a:hover {
            color: #007acc;
        }
        .site-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #007acc;
        }
        main {
            background: #fff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .post-meta {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        .post-content h1, .post-content h2, .post-content h3 {
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .post-list {
            list-style: none;
            padding: 0;
        }
        .post-list li {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }
        .post-list h2 {
            margin: 0 0 0.5rem 0;
        }
        .post-list h2 a {
            text-decoration: none;
            color: #333;
        }
        .post-list h2 a:hover {
            color: #007acc;
        }
        footer {
            text-align: center;
            padding: 2rem 0;
            color: #666;
            border-top: 1px solid #ddd;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <a href="https://canuxcheng.com/" class="site-title">Morgoth</a>
                
                    <a href="/">Home</a>
                
                    <a href="/about/">About</a>
                
                    <a href="/categories/">Categories</a>
                
                    <a href="/tags/">Tags</a>
                
                    <a href="/rtfm/">RTFM</a>
                
                    <a href="/samuel/">Samuel</a>
                
            </nav>
        </div>
    </header>
    
    <div class="container">
        <main>
            
<div class="single-post">
    <article>
        <header>
            <h1>NPM</h1>
            <div class="post-meta">
                <time>September 27, 2016</time>
                
                    
                        <span class="category">Web</span>
                    
                
                
                    
                        <span class="tag">#npm</span>
                    
                
            </div>
        </header>
        
        <div class="post-content">
            <h1 id="npm">NPM</h1>
<p><a href="https://www.npmjs.cn/">https://www.npmjs.cn/</a></p>
<p>npm: node package manager.</p>
<p>npm 由三部分组成：</p>
<ul>
<li>website <a href="https://www.npmjs.com">https://www.npmjs.com</a></li>
<li>CLI</li>
<li>registry <a href="https://registry.npmjs.org">https://registry.npmjs.org</a></li>
</ul>
<p>config:</p>
<pre><code>// 修改registry
$ npm config set registry https://registry.npm.taobao.org
$ npm config get registry

// 修改默认全局安装路径
mkdir /path/npm_global
npm config set prefix /path/npm_global
echo 'export PATH=/path/npm_global/bin:$PATH' &gt;&gt; ~/.profile
source ~/.profile

// 查看配置
$ npm config ls -l
</code></pre>
<p>install:</p>
<pre><code>// 根据当前目录package.json安装到当前目录node_modules
$ npm install

// 安装pkg到当前目录的 node_modules
$ npm install &lt;pkg&gt;

// 安装到全局的node_modules
$ npm install -g &lt;name&gt;

--save-dev // 安装并自动更新到package.json的devDependencies.
--no-save // 不保存到package.json 和 package-lock.json.
--no-package-lock // 不生成package-lock.json
</code></pre>
<p>list:</p>
<pre><code>// 查看安装了哪些包
$ npm list --depth=0 --global
</code></pre>
<p>init:</p>
<pre><code>// 创建package.json
$ npm init
</code></pre>
<p>test:</p>
<pre><code>$ npm test
</code></pre>
<p>publish:</p>
<pre><code># 注册npm账号
# 添加账号
npm adduser
# 验证账号 
npm whoami
# 发布
npm publish
</code></pre>
<p>发布好了可以去npm网站查看.</p>
<p>npm + shrinkwrap = yarn lock
npm-shrinkwrap.json = yarn.lock</p>
<h2 id="folders">folders</h2>
<p>nodejs加载的路径:</p>
<pre><code>1. 当前目录
2. $HOME/.node_modules
   $HOME/.node_libraries
   $PREFIX/lib/node_modules
3. $NODE_PATH

// 查看prefix (也是-g 安装的目录)
$ npm config ls -l | grep prefix
</code></pre>
<hr>
<h2 id="npmrc">npmrc</h2>
<p>get token</p>
<pre><code>curl -u&lt;username&gt;:&lt;api-key&gt; https://artifactory.canux.com/artifactory/api/npm/auth
</code></pre>
<p>&ldquo;.npmrc&rdquo; 配置private registry</p>
<pre><code>registry=https://artifactory.canux.com/artifactory/api/npm/iep.npm-virtual
always-auth=true 
email=&lt;user-email&gt;
//artifactory.arm.com/artifactory/api/npm/:_auth=&lt;token&gt;
</code></pre>
<h2 id="npmignore">npmignore</h2>
<p>打包的时候忽略的文件和目录，优先级高于gitignore。</p>
<h2 id="packagejson">package.json</h2>
<p>package.json</p>
<p>package-locks</p>
<p>package-lock.json</p>
<hr>
<h2 id="yarn">yarn</h2>
<p><a href="https://yarnpkg.com/">https://yarnpkg.com/</a></p>
<p>使用corepack安装yarn。</p>
<p>激活corepack</p>
<pre><code>$ corepack enable
</code></pre>
<p>安装yarn</p>
<pre><code>$ corepack prepare yarn@3.8.1 --activate
</code></pre>
<p>CLI:</p>
<pre><code>// yarn config, yarn 会读npmrc
yarn config

cacheFolder: $HOME/.yarn/berry/cache
globalFolder: $HOME/.yarn/berry

// create package.json
$ yarn init

// 设置project的yarn version，自动下载.yarn/release/yarn-&lt;version&gt;.cjs
yarn set version berry

// remove all local archives
$ yarn cache clean  

// add/remove/install dependencies
$ yarn add ...
$ yarn remove ...
$ yarn install --inline-builds

// nodejs
$ yarn node

// check npm package information
$ yarn npm info react

// run script defined in package.json
$ yarn run &lt;scriptName&gt;

//  plugin management
$ yarn plugin ......

//  workspace management
$ yarn workspaces ...
$ yarn workspaces list
$ yarn workspaces foreach // run command on all workspaces

// login to private registry
yarn npm login
yarn npm logout
yarn npm publish

    npmRegistries:
        &quot;https://artifactory.arm.com/artifactory/api/npm/iep.npm-virtual&quot;: 
            npmAuthToken: &lt;token&gt;

yarn build 
&quot;exports&quot;: {
    &quot;.&quot;: &quot;./src/index.ts&quot;,
    &quot;./alpha&quot;: &quot;./src/alpha.ts&quot;,
    &quot;./package.json&quot;: &quot;./package.json&quot;
},
</code></pre>

        </div>
    </article>
</div>

        </main>
    </div>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 Morgoth. Designed by Canux</p>
        </div>
    </footer>
</body>
</html>
