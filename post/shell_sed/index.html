<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sed - Morgoth</title>
    <meta name="description" content="">
    
    
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: #fff;
            padding: 1rem 0;
            border-bottom: 1px solid #ddd;
            margin-bottom: 2rem;
        }
        nav {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        nav a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
        }
        nav a:hover {
            color: #007acc;
        }
        .site-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #007acc;
        }
        main {
            background: #fff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .post-meta {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        .post-content h1, .post-content h2, .post-content h3 {
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .post-list {
            list-style: none;
            padding: 0;
        }
        .post-list li {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }
        .post-list h2 {
            margin: 0 0 0.5rem 0;
        }
        .post-list h2 a {
            text-decoration: none;
            color: #333;
        }
        .post-list h2 a:hover {
            color: #007acc;
        }
        footer {
            text-align: center;
            padding: 2rem 0;
            color: #666;
            border-top: 1px solid #ddd;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <a href="https://canuxcheng.com/" class="site-title">Morgoth</a>
                
                    <a href="/">Home</a>
                
                    <a href="/about/">About</a>
                
                    <a href="/categories/">Categories</a>
                
                    <a href="/tags/">Tags</a>
                
                    <a href="/rtfm/">RTFM</a>
                
                    <a href="/samuel/">Samuel</a>
                
            </nav>
        </div>
    </header>
    
    <div class="container">
        <main>
            
<div class="single-post">
    <article>
        <header>
            <h1>Sed</h1>
            <div class="post-meta">
                <time>April 2, 2016</time>
                
                    
                        <span class="category">Linux</span>
                    
                
                
                    
                        <span class="tag">#shell</span>
                    
                
            </div>
        </header>
        
        <div class="post-content">
            <h1 id="sed">sed</h1>
<p>sed：stream editor  流编辑器 ，主要用于文本处理。</p>
<p>sed命令格式：</p>
<pre><code>sed   -options   ’expression1;expression2’     file           执行多个命令
sed   -options   [-e ‘expression1’] [-e ‘expression2’]  file  执行多个命令
sed   -options   [-f   scriptfile]   file                     通过脚本执行命令
sed   -options   [-f   scriptfile]   file  &gt;  newfile  #sed修改后重定向到新文件。
</code></pre>
<p>sed指令需要用单引号包围。使用双引号“”可以传递变量。
Sed默认并没有修改文件file中的数据。
sed默认在stdout输出文件的所有行。
Sed地址需要使用/address/来包围。
sed使用正则表达式可以用\BRE\包围，如果模式包含/，那么可以使用除了换行符之外的所有字符包围。</p>
<p>options：</p>
<pre><code>-e：指定多个命令或脚本
-f：指定执行命令的脚本
-n：阻止自动输出，p可以打印匹配的行。
-i: 直接修改读入的文件的内容.
</code></pre>
<p>experssion：</p>
<pre><code>expression：指令由模式和过程组成。
[address]/[line-address][!]command[arguments]
[address]表示地址，一般用模式进行寻址，address缺省表示整个文件寻址，两个地址用，隔开。
[line-address]表示只能是一个地址。
[!] 表示不匹配该地址的所有行
</code></pre>
<p>Command:</p>
<p>sed有25个命令。</p>
<p>使用大括号{}在一个地址中做嵌套操作：例如：</p>
<pre><code>/address1/,/address2/{
    /^$/d
    s/string1/string2/
    …
}             // 单独一行，后面不能有空格
</code></pre>
<p>s命令：替换，替换模式空间中的行。</p>
<pre><code>sed '[address]s/oldpattern/newpattern/[flag]' filename
</code></pre>
<p>flag:</p>
<pre><code>n:替换每个寻址行的第n个匹配模式。默认n=1. n在1-512之间。
g:替换每个寻址行的所有匹配模式。
p:打印模式空间的内容
w file：如果发生替换就将这一行写入file。只写入替换的行,不写入其它行.
</code></pre>
<p>用反斜杠\转义换行符：</p>
<p>因为反斜杠在newpattern中也用于包含换行符。</p>
<pre><code>// 将匹配的项替换成两个换行符。
sed '
s/pattern/\ (换行）
\           （换行）
string/' filename
等价于：
sed 's/pattern/\n\n/' filename
</code></pre>
<p>用反斜杠\转义与符号&amp;：</p>
<pre><code>// 结果是： string1 pattern string2 
sed 's/pattern/string1 &amp; string2/g' filename
</code></pre>
<p>如果不转义&amp;匹配整个pattern:</p>
<pre><code>// 结果是：string1 &amp; string2
sed 's/pattern/string1 \&amp; string2/g' filename
</code></pre>
<p>用反斜杠\转义\n:</p>
<pre><code>// 将pattern中匹配到的第一个字串回调到newpattern中使用。
sed 's/pattern/\1/' filename
</code></pre>
<p>d命令：删除，删除模式空间中的行，并不删除文件中的行。</p>
<pre><code>'[address]d'
'1d' 删除第一行
'$d' 删除最后一行
’/^$/d' 删除空行
‘/^\s\+$/d’  删除空白行（没有数字字符）
‘/^\s*$/d’ 删除空白行（没有数字字符）
</code></pre>
<p>a/i/c命令：追加/插入/更改.</p>
<pre><code>// 在匹配到的行下面添加追加的内容
'[line-address]a string' filename
'[line-address]a\
string1\
string2\
string3' filename   （追加三行）
</code></pre>
<p>i:同上，在匹配到的行上面插入内容。</p>
<pre><code>// 将匹配到的行替换掉。
'[address]c string' filename
'[address]c\
string1\
string2\
string3' filename
</code></pre>
<p>l：列表命令</p>
<pre><code>sed '[address]l' filename   打印模式空间内容，将非打印字符显示为ASCII码
</code></pre>
<p>p：打印命令</p>
<pre><code>sed '[address]p' filename   打印模式空间内容
</code></pre>
<p>=：打印行号</p>
<pre><code>sed -n '[line-address]='  filename  只打印行号
</code></pre>
<p>n：下一步</p>
<pre><code>sed '[address]n' filename
</code></pre>
<p>q:退出命令</p>
<pre><code>// 一旦找到和line-address匹配的行，脚本立即退出。
sed '[line-address]q' filename
</code></pre>
<p>r/w:读/写命令</p>
<pre><code>// 读file文件追加在匹配到的行后面。
sed '[line-address]r file'   filename

// 将匹配到的行写入到file文件中
sed '[address]w file'  filename

sed –I 's/.*/\L&amp;/g' urfile   全部转换成小写
sed  -I 's/.*/\U&amp;/g' urfile 全部转换成大写。
sed   ‘/pattern/{{n; p;}}’   urfile   读取pattern下一行并打印。
</code></pre>
<p>n：追加下一个输入行到匹配后面并在两者间嵌入新行，改变行号。</p>
<p>p：打印匹配的第一行。</p>
<h1 id="常用">常用</h1>
<pre><code>sed   ‘$a   string’   filenames           #批量往文件最后一行添加内容
sed   ‘$i    string’   filenames           #批量往文件倒数第二行添加内容
string里面有空格用\开头。
</code></pre>

        </div>
    </article>
</div>

        </main>
    </div>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 Morgoth. Designed by Canux</p>
        </div>
    </footer>
</body>
</html>
