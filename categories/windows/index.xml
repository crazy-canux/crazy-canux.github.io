<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Windows on Morgoth</title>
    <link>https://canuxcheng.com/categories/windows/</link>
    <description>Recent content in Windows on Morgoth</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 18 Jul 2016 14:54:39 +0000</lastBuildDate>
    <atom:link href="https://canuxcheng.com/categories/windows/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Remote Management</title>
      <link>https://canuxcheng.com/post/ps_remote/</link>
      <pubDate>Mon, 18 Jul 2016 14:54:39 +0000</pubDate>
      <guid>https://canuxcheng.com/post/ps_remote/</guid>
      <description>&lt;h1 id=&#34;windows远程管理&#34;&gt;Windows远程管理&lt;/h1&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;WinRM, 远程处理,在远程机器上执行命令&lt;/li&gt;&#xA;&lt;li&gt;WMI/CIM&lt;/li&gt;&#xA;&lt;li&gt;RPC, 远程连接,在发起远程连接的机器上执行命令&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;hr&gt;&#xA;&lt;h1 id=&#34;winrm&#34;&gt;WinRM&lt;/h1&gt;&#xA;&lt;p&gt;一对一远程处理:&lt;/p&gt;&#xA;&lt;p&gt;类似于linux的ssh。&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Enter-PSSession -ComputerName name&#xA;...&#xA;Exit-PSSession&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;一对多远程处理:&lt;/p&gt;&#xA;&lt;p&gt;同时远程到多台机器执行命令或脚本。&lt;/p&gt;&#xA;&lt;p&gt;Invoke-Command一次创建一个连接对象，返回PSComputerName属性，执行完后就关闭连接。&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Invoke-Command -ComputerName name1,name2 -ScriptBlock {command1;command2}&#xA;&#xA;Invoke-Command -ComputerName name1,name2 -FilePath filepath&#xA;&#xA;Invoke-Command -ComputerName (Get-Content hosts.txt) ...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;通过argumentlist把本地的参数传给远程的命令:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$lvar1=&amp;quot;value1&amp;quot;&#xA;$lvar2=&amp;quot;value2&amp;quot;&#xA;Invoke-Command -ComputerName name&#xA;-ScriptBlock {&#xA;Param($var1, $var2)&#xA;...&#xA;}&#xA;-ArgumentList $lvar1, $lvar2&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;通过$using:传本地参数到远程机器：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$var1=&amp;quot;value1&amp;quot;&#xA;Invoke-Command -ComputerName name&#xA;-ScriptBlock {&#xA;... $using:var1&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;创建持久的远程处理：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$session1=New-PSSession -ComputerName server1&#xA;Enter-PSSession -Session $session1 ...&#xA;Invoke-Command -Session $session1 ...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;hr&gt;&#xA;&lt;h1 id=&#34;wmi&#34;&gt;WMI&lt;/h1&gt;&#xA;&lt;pre&gt;&lt;code&gt;Get-WmiObject&#xA;Remove-WmiObject&#xA;Invoke-WmiMethod&#xA;Register-WmiEvent&#xA;Set-WmiInstance&#xA;&#xA;# 用powershell跑一个wql。&#xA;Get-WmiObject -Query &amp;quot;select * from win32_service where name=&#39;winRM&#39;&amp;quot; | Format-List -Property Name,status&#xA;&#xA;# 远程管理&#xA;Get-WMIObject -ComputerName ...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h1 id=&#34;cim&#34;&gt;CIM&lt;/h1&gt;&#xA;&lt;pre&gt;&lt;code&gt;Get-CimClass&#xA;Get-CimInstance&#xA;Get-CimSession&#xA;Get-CimAssociatedInstance&#xA;Invoke-CimMethod&#xA;New-CimInstance&#xA;New-CimSession&#xA;New-CimSessionOption&#xA;Register-CimIndicationEvent&#xA;Remove-CimInstance&#xA;Remove-CimSession&#xA;Set-CimInstance&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;hr&gt;&#xA;&lt;h1 id=&#34;rpc&#34;&gt;RPC&lt;/h1&gt;&#xA;&lt;pre&gt;&lt;code&gt;# 远程连接&#xA;Get-Service -ComputerName ...&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>WinRM</title>
      <link>https://canuxcheng.com/post/win_winrm/</link>
      <pubDate>Sun, 17 Jul 2016 08:36:36 +0000</pubDate>
      <guid>https://canuxcheng.com/post/win_winrm/</guid>
      <description>&lt;h1 id=&#34;winrm&#34;&gt;WinRM&lt;/h1&gt;&#xA;&lt;p&gt;Windows Remote Management&lt;/p&gt;&#xA;&lt;p&gt;WinRM是WSMAN(WS-Management Protocol)的增强版。&lt;/p&gt;&#xA;&lt;p&gt;WinRM是基于SOAP的防火墙友好的远程协议。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://msdn.microsoft.com/en-us/library/aa384426(v=vs.85).aspx&#34;&gt;https://msdn.microsoft.com/en-us/library/aa384426(v=vs.85).aspx&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;WinRM设置:&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx&#34;&gt;https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;检查winrm所有配置：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;cmd&amp;gt; winrm get winrm/config&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;快速设置winrm：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;cmd&amp;gt; winrm quickconfig&#xA;cmd&amp;gt; winrm quickconfig -transport:https&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;查看listener配置：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;cmd&amp;gt; winrm enumerate winrm/config/listener&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;WinRM配置包括监听设置,协议设置,Client,Service和Winrs四部分.&lt;/p&gt;&#xA;&lt;p&gt;windows的三种网络安全协议。&lt;/p&gt;&#xA;&lt;p&gt;Basic是基本的明文协议, NTLM是早期的安全协议,Kerberos是最新的安全协议.&lt;/p&gt;&#xA;&lt;h1 id=&#34;service权限管理&#34;&gt;service权限管理&lt;/h1&gt;&#xA;&lt;p&gt;查看service的auth配置：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;cmd&amp;gt; winrm get winrm/config/service/auth&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;service只有Negotiate和Kerberos是默认开启的:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Basic = false&#xA;Kerberos = true&#xA;Negotiate = true&#xA;Certificate = false&#xA;CredSSP = false&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;Negotiate对domain用户选择kerberos,对local用户选择NTLM.&lt;/p&gt;&#xA;&lt;p&gt;设置service的Basic和Certificate和CredSSP(默认关闭)：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;#cmd&amp;gt; winrm set winrm/config/service/auth @{Basic=&amp;quot;true&amp;quot;}&#xA;#cmd&amp;gt; winrm set winrm/config/service/auth @{Certificate=&amp;quot;true&amp;quot;}&#xA;#cmd&amp;gt; winrm set winrm/config/service/auth @{CredSSP=&amp;quot;true&amp;quot;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;设置是否允许不加密：&lt;/p&gt;</description>
    </item>
    <item>
      <title>Coreutils</title>
      <link>https://canuxcheng.com/post/ps_coreutils/</link>
      <pubDate>Tue, 12 Jul 2016 17:24:25 +0000</pubDate>
      <guid>https://canuxcheng.com/post/ps_coreutils/</guid>
      <description>&lt;h1 id=&#34;外部命令&#34;&gt;外部命令&lt;/h1&gt;&#xA;&lt;p&gt;powershell可以执行外部命令.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;C:\Windows\System32\*.exe&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h1 id=&#34;cmd&#34;&gt;cmd&lt;/h1&gt;&#xA;&lt;h1 id=&#34;ping&#34;&gt;ping&lt;/h1&gt;&#xA;&lt;h1 id=&#34;netstat&#34;&gt;netstat&lt;/h1&gt;&#xA;&lt;h1 id=&#34;ipconfig&#34;&gt;ipconfig&lt;/h1&gt;&#xA;&lt;h1 id=&#34;route&#34;&gt;route&lt;/h1&gt;&#xA;&lt;h1 id=&#34;arp&#34;&gt;arp&lt;/h1&gt;&#xA;&lt;h1 id=&#34;nslookup&#34;&gt;nslookup&lt;/h1&gt;&#xA;&lt;h1 id=&#34;ftp&#34;&gt;ftp&lt;/h1&gt;&#xA;&lt;h1 id=&#34;mstsc&#34;&gt;mstsc&lt;/h1&gt;&#xA;&lt;p&gt;RDP client.&lt;/p&gt;&#xA;&lt;h1 id=&#34;taskmgr&#34;&gt;taskmgr&lt;/h1&gt;&#xA;&lt;p&gt;任务管理器．&lt;/p&gt;&#xA;&lt;h1 id=&#34;tskill&#34;&gt;tskill&lt;/h1&gt;&#xA;&lt;h1 id=&#34;tree&#34;&gt;tree&lt;/h1&gt;&#xA;&lt;h1 id=&#34;whoami&#34;&gt;whoami&lt;/h1&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;需要下载，然后放入环境变量的第三方命令.&lt;/p&gt;&#xA;&lt;h1 id=&#34;windump&#34;&gt;WinDump&lt;/h1&gt;&#xA;&lt;p&gt;Windows版本的tcpdump, 依赖WinPcap包．&lt;/p&gt;&#xA;&lt;p&gt;通过windump导出的*.pcap文件可以通过wireshark打开．&lt;/p&gt;</description>
    </item>
    <item>
      <title>Builtins</title>
      <link>https://canuxcheng.com/post/ps_builtins/</link>
      <pubDate>Tue, 24 May 2016 10:44:44 +0000</pubDate>
      <guid>https://canuxcheng.com/post/ps_builtins/</guid>
      <description>&lt;h1 id=&#34;get-help和help&#34;&gt;Get-Help和Help:&lt;/h1&gt;&#xA;&lt;p&gt;get-help查看帮助信息,help分页查看帮助信息，man是help的别名&lt;/p&gt;&#xA;&lt;p&gt;命令说明：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Get-Help&#xA;Help&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;查看所有命令和概念：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Get-Help *&#xA;Help *&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;模糊查找命令和概念：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Get-Help *&amp;lt;name&amp;gt;*&#xA;Help *&amp;lt;name&amp;gt;*&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;查看具体命令帮助：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Get-Help {&amp;lt;CmdletName&amp;gt; | &amp;lt;TopicName&amp;gt;}&#xA;Help {&amp;lt;CmdletName&amp;gt; | &amp;lt;TopicName&amp;gt;}&#xA;&amp;lt;CmdletName&amp;gt; -?&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;get-help/help的选项:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;get-help get-help&#xA;-examples # 查看示例&#xA;-full # 查看所有帮助&#xA;-parameter # 查看选项的帮助&#xA;-detailed # 查看详细信息&#xA;-online # 打开文档中的link&#xA;-showwindow # 用窗口打开&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h1 id=&#34;helpfile&#34;&gt;Helpfile&lt;/h1&gt;&#xA;&lt;p&gt;3.0/4.0 需要先下载帮助手册：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;update-help&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;所有helpfile：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Get-Help/Help about_*&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;查看具体helpfile：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Get-Help/Help about_&amp;lt;name&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;hr&gt;&#xA;&lt;h1 id=&#34;cmdlets&#34;&gt;Cmdlets&lt;/h1&gt;&#xA;&lt;p&gt;cmdlets是powershell的内置命令,类型是System.Management.Automation.CmdletInfo&lt;/p&gt;&#xA;&lt;p&gt;cmdlets的方法：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Equals&#xA;GetHashCode&#xA;GetType&#xA;ToString&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;cmdlets的属性：&lt;/p&gt;</description>
    </item>
    <item>
      <title>Admin</title>
      <link>https://canuxcheng.com/post/win_admin/</link>
      <pubDate>Tue, 26 Apr 2016 09:54:45 +0000</pubDate>
      <guid>https://canuxcheng.com/post/win_admin/</guid>
      <description></description>
    </item>
    <item>
      <title>PowerShell</title>
      <link>https://canuxcheng.com/post/ps/</link>
      <pubDate>Tue, 26 Apr 2016 09:52:02 +0000</pubDate>
      <guid>https://canuxcheng.com/post/ps/</guid>
      <description>&lt;h1 id=&#34;powershell&#34;&gt;PowerShell&lt;/h1&gt;&#xA;&lt;p&gt;Console: command line interface&lt;/p&gt;&#xA;&lt;p&gt;ISE: script editor and console combination&lt;/p&gt;&#xA;&lt;p&gt;Version:&lt;/p&gt;&#xA;&lt;p&gt;2.0,3.0,4.0,5.0&lt;/p&gt;&#xA;&lt;p&gt;C:\Windows\System32\powershell 存放64位powershell&lt;/p&gt;&#xA;&lt;p&gt;C:\Windows\SysWOW64\powershell 存放32位powershell&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;gt;$PSVersionTable&#xA;&amp;gt;$HOST&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;Install/Update:&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.microsoft.com/zh-CN/download/details.aspx?id=40855&#34;&gt;https://www.microsoft.com/zh-CN/download/details.aspx?id=40855&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;安装Windows Management Framework4.0即可。&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;gt;$PSHOME&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;多版本时切换版本:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;gt;powershell -version 2&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;hr&gt;&#xA;&lt;h1 id=&#34;powershell相关项目&#34;&gt;powershell相关项目&lt;/h1&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Microsoft&#34;&gt;https://github.com/Microsoft&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/PowerShell&#34;&gt;https://github.com/PowerShell&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/PowerShellOrg&#34;&gt;https://github.com/PowerShellOrg&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;win32-openssh&#34;&gt;win32-openssh&lt;/h2&gt;&#xA;&lt;p&gt;windows的SSH。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/PowerShell/Win32-OpenSSH&#34;&gt;https://github.com/PowerShell/Win32-OpenSSH&lt;/a&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h1 id=&#34;powershell命令&#34;&gt;powershell命令&lt;/h1&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;gt;powershell -?&#xA;&amp;gt;powershell /?&#xA;&amp;gt;powershell -help&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;hr&gt;&#xA;&lt;h1 id=&#34;powershell-script&#34;&gt;powershell script&lt;/h1&gt;&#xA;&lt;p&gt;powershell是默认大小写不敏感的。&lt;/p&gt;&#xA;&lt;p&gt;同一行多个命令需要用分号;隔开。&lt;/p&gt;&#xA;&lt;p&gt;powershell的安全策略：&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;restricted(default)&lt;/li&gt;&#xA;&lt;li&gt;allsigned&lt;/li&gt;&#xA;&lt;li&gt;remotesigned&lt;/li&gt;&#xA;&lt;li&gt;unrestricted&lt;/li&gt;&#xA;&lt;li&gt;bypass&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h1 id=&#34;注释&#34;&gt;注释&lt;/h1&gt;&#xA;&lt;p&gt;单行注释：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# comment&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;多行注释(文档注释)：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;#&#xA;comment1&#xA;comment2&#xA;...&#xA;#&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;帮助文档:&lt;/p&gt;</description>
    </item>
    <item>
      <title>Utils</title>
      <link>https://canuxcheng.com/post/ps_utils/</link>
      <pubDate>Tue, 26 Apr 2016 09:52:02 +0000</pubDate>
      <guid>https://canuxcheng.com/post/ps_utils/</guid>
      <description>&lt;h1 id=&#34;windows相关项目&#34;&gt;windows相关项目：&lt;/h1&gt;&#xA;&lt;h2 id=&#34;choco&#34;&gt;choco&lt;/h2&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/chocolatey&#34;&gt;https://github.com/chocolatey&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;windows的apt/yum。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/chocolatey/choco&#34;&gt;choco&lt;/a&gt; is replacement of &lt;a href=&#34;https://github.com/chocolatey/chocolatey&#34;&gt;chocolatey&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;choco install openssh&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 id=&#34;cmder&#34;&gt;cmder&lt;/h2&gt;&#xA;&lt;p&gt;cmd的升级版。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/cmderdev/cmder&#34;&gt;https://github.com/cmderdev/cmder&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;babun&#34;&gt;babun&lt;/h2&gt;&#xA;&lt;p&gt;a linux-shell like on windows.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/babun/babun&#34;&gt;https://github.com/babun/babun&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;flinux&#34;&gt;flinux&lt;/h2&gt;&#xA;&lt;p&gt;run unmodified linux applications inside windows&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/wishstudio/flinux&#34;&gt;https://github.com/wishstudio/flinux&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI</title>
      <link>https://canuxcheng.com/post/win_wmi/</link>
      <pubDate>Sun, 03 Apr 2016 14:15:47 +0000</pubDate>
      <guid>https://canuxcheng.com/post/win_wmi/</guid>
      <description>&lt;h1 id=&#34;wmicim&#34;&gt;WMI/CIM&lt;/h1&gt;&#xA;&lt;p&gt;WMI: windows management instrumentation.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://msdn.microsoft.com/en-us/library/aa394582(v=vs.85).aspx&#34;&gt;https://msdn.microsoft.com/en-us/library/aa394582(v=vs.85).aspx&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;CIM: common information model.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://msdn.microsoft.com/en-us/library/aa389234(v=vs.85).aspx&#34;&gt;https://msdn.microsoft.com/en-us/library/aa389234(v=vs.85).aspx&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;DCOM: distributed COM.&lt;/p&gt;&#xA;&lt;p&gt;wmi通过DCOM远程连接，但是DCOM不能绕过防火墙。&lt;/p&gt;&#xA;&lt;p&gt;命名空间:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root\cimv2&#xA;root\microsoftdns&#xA;root\securitycenter&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;WMI工具：&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;windows自带wmi测试工具wbemtest.&lt;/li&gt;&#xA;&lt;li&gt;WMI Explorer用于查找wmi和cim的Class和Properties.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;a href=&#34;http://www.ks-soft.net/hostmon.eng/wmi/index.htm#SysReq&#34;&gt;http://www.ks-soft.net/hostmon.eng/wmi/index.htm#SysReq&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;windows怎样设置wmi：&lt;/p&gt;&#xA;&lt;p&gt;135 (Microsoft RPC), 137-139 (NetBIOS) and 445 (Microsoft DS). These are TCP ports.&lt;/p&gt;&#xA;&lt;p&gt;设置的用户需要是管理员组。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://technet.microsoft.com/en-us/library/cc771551(v=ws.11).aspx&#34;&gt;https://technet.microsoft.com/en-us/library/cc771551(v=ws.11).aspx&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;给wmi设置fix port(server in DMZ)：&lt;/p&gt;&#xA;&lt;p&gt;使用过程中不需要指定端口。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://msdn.microsoft.com/zh-cn/library/bb219447(v=vs.85).aspx&#34;&gt;https://msdn.microsoft.com/zh-cn/library/bb219447(v=vs.85).aspx&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h1 id=&#34;wmic&#34;&gt;wmic&lt;/h1&gt;&#xA;&lt;p&gt;wmic是wmi的客户端命令。&lt;/p&gt;&#xA;&lt;p&gt;windows的wmic：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;gt;wmic # 进入wmi的交互模式&#xA;&amp;gt;wmic -? # 查看帮助&#xA;&amp;gt;wmic /? # 查看帮助&#xA;&amp;gt;wmic ... # 非交互模式运行命令&#xA;&amp;gt;wmic process call create shutdown.exe # 本地关机&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;linux的wmic：&lt;/p&gt;</description>
    </item>
    <item>
      <title>FileSystem</title>
      <link>https://canuxcheng.com/post/win_filesystem/</link>
      <pubDate>Sun, 03 Apr 2016 14:15:40 +0000</pubDate>
      <guid>https://canuxcheng.com/post/win_filesystem/</guid>
      <description></description>
    </item>
    <item>
      <title>Monitoring</title>
      <link>https://canuxcheng.com/post/win_monitoring/</link>
      <pubDate>Sun, 03 Apr 2016 14:15:40 +0000</pubDate>
      <guid>https://canuxcheng.com/post/win_monitoring/</guid>
      <description>&lt;h1 id=&#34;windows的services和process&#34;&gt;windows的services和process&lt;/h1&gt;&#xA;&lt;p&gt;services是windows的服务，有Name(Display Name)，Service Name，Description等属性。&lt;/p&gt;&#xA;&lt;p&gt;process是以.exe为后缀的application，有Name(product name)、original filename(Image Name)、file description(description)等属性。&lt;/p&gt;</description>
    </item>
    <item>
      <title>Windows</title>
      <link>https://canuxcheng.com/post/win/</link>
      <pubDate>Sun, 03 Apr 2016 14:15:40 +0000</pubDate>
      <guid>https://canuxcheng.com/post/win/</guid>
      <description>&lt;h1 id=&#34;windows的ide&#34;&gt;windows的IDE&lt;/h1&gt;&#xA;&lt;p&gt;VS Enterprise: 收费企业版&#xA;VS Professional: 收费个人版&#xA;VS Community: 免费社区版&lt;/p&gt;&#xA;&lt;p&gt;windows的引导程序是ntloader。&lt;/p&gt;&#xA;&lt;p&gt;DOS和NT是windows系统的内核。&lt;/p&gt;&#xA;&lt;p&gt;BIOS和MBR基本输入输出系统和主引导记录。&lt;/p&gt;&#xA;&lt;p&gt;UEFI和GPT是统一的可扩展接口和GUID分区表。&lt;/p&gt;&#xA;&lt;p&gt;FAT是msdos的文件系统&lt;/p&gt;&#xA;&lt;p&gt;NTFS是msnt的文件系统&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h1 id=&#34;ad&#34;&gt;AD&lt;/h1&gt;&#xA;&lt;p&gt;AD: Active Directory&lt;/p&gt;&#xA;&lt;p&gt;管理工具：LDAPSoft AD Browser&lt;/p&gt;</description>
    </item>
    <item>
      <title>Regular Expression</title>
      <link>https://canuxcheng.com/post/regularexpression/</link>
      <pubDate>Sat, 02 Apr 2016 11:16:16 +0000</pubDate>
      <guid>https://canuxcheng.com/post/regularexpression/</guid>
      <description>&lt;h1 id=&#34;re&#34;&gt;RE&lt;/h1&gt;&#xA;&lt;p&gt;在线检测：&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.regexpal.com/&#34;&gt;https://www.regexpal.com/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;RE分为BRE(basic RE), ERE(extended RE), SRE(simpla RE).&lt;/p&gt;&#xA;&lt;p&gt;在BRE中+?(){}|没有特殊含义，除非用\转义．&lt;/p&gt;&#xA;&lt;p&gt;在ERE中+?(){}被保留有特殊含义，除非用\转义才表示普通字符．&lt;/p&gt;&#xA;&lt;p&gt;命令find, grep, sed, awk等都可以使用正则表达式．&lt;/p&gt;&#xA;&lt;p&gt;特殊字符含义：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;()      对正则表达式分组, ERE&#xA;\n      再匹配前面的分组n次&#xA;&#xA;.       匹配任意单个字符, 换行符除外&#xA;^tux    匹配以tux开始的行&#xA;tux$    匹配以tux结束的行&#xA;&#xA;*+?{}特殊字符是贪婪匹配模式,也就是尽可能多的匹配&#xA;*           匹配前面一个字符0次或多次，包括前面这个字符本身&#xA;+           匹配前面一个字符1次或多次，包括前面这个字符, ERE&#xA;?           匹配前面一个字符0次或1次，包括前面这个字符, ERE&#xA;{n}         匹配前面一个字符n次，包括前面这个字符, ERE&#xA;{min,}      匹配前面一个字符至少min次，包括前面这个字符, ERE&#xA;{min,max}   匹配前面一个字符至少min次，最多max次，包括前面这个字符, ERE&#xA;&#xA;下面是非贪婪匹配模式&#xA;*?    匹配0个或多个&#xA;+?    匹配1个或多个&#xA;??    匹配０个或１个&#xA;{n}?        只匹配n个&#xA;{min,}?     至少min个&#xA;{min,max}?  至少min个，最多max个&#xA;&#xA;[abc]   匹配包含在[]中的任意一个字符，除了\, ^, -三个特殊字符&#xA;[^abc]  匹配不包含在[]中的任意一个字符(和上面相反)&#xA;[a-z]   匹配[]中指定范围内的任意一个字符&#xA;[abc\?] 用＼转义[]中的特殊字符&#xA;&#xA;|       表示逻辑或, ERE&#xA;&#xA;\       转义字符，将特殊字符转义成普通字符&#xA;&#xA;小括号表示分组&#xA;(...)&#xA;(?...)&#xA;(?iLmsux)&#xA;(?:...)&#xA;(?P&amp;lt;name&amp;gt;...)&#xA;(?P=name)&#xA;(?#...)&#xA;(?=...)&#xA;(?!...)&#xA;(?&amp;lt;=...)&#xA;(?&amp;lt;!...)&#xA;(?(id/name)yes-pattern|no-pattern)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;匹配前面一个字符０次，包括前面这个字符，也就是说０次表示不匹配前面这个字符．&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
