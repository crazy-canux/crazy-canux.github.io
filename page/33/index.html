<!DOCTYPE html>
<html lang="en">
<head>
	<meta name="generator" content="Hugo 0.147.9">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morgoth - Morgoth</title>
    <meta name="description" content="">
    
    
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: #fff;
            padding: 1rem 0;
            border-bottom: 1px solid #ddd;
            margin-bottom: 2rem;
        }
        nav {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        nav a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
        }
        nav a:hover {
            color: #007acc;
        }
        .site-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #007acc;
        }
        main {
            background: #fff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .post-meta {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        .post-content h1, .post-content h2, .post-content h3 {
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .post-list {
            list-style: none;
            padding: 0;
        }
        .post-list li {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }
        .post-list h2 {
            margin: 0 0 0.5rem 0;
        }
        .post-list h2 a {
            text-decoration: none;
            color: #333;
        }
        .post-list h2 a:hover {
            color: #007acc;
        }
        footer {
            text-align: center;
            padding: 2rem 0;
            color: #666;
            border-top: 1px solid #ddd;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <a href="https://canuxcheng.com/" class="site-title">Morgoth</a>
                
                    <a href="/">Home</a>
                
                    <a href="/about/">About</a>
                
                    <a href="/categories/">Categories</a>
                
                    <a href="/tags/">Tags</a>
                
                    <a href="/rtfm/">RTFM</a>
                
                    <a href="/samuel/">Samuel</a>
                
            </nav>
        </div>
    </header>
    
    <div class="container">
        <main>
            
<div class="home">
    <h1>Morgoth</h1>
    <p></p>
    
    <section class="recent-posts">
        <h2>Recent Posts</h2>
        <ul class="post-list">
            
                <li>
                    <h2><a href="https://canuxcheng.com/post/django_admin/">Admin</a></h2>
                    <div class="post-meta">
                        <time>October 4, 2016</time>
                        
                            
                                <span class="category">Django</span>
                            
                        
                    </div>
                    
                        <p><h1 id="adminpy">admin.py</h1>
<pre><code>from django.contrib import admin
</code></pre>
<p>创建一个管理员用户：</p>
<pre><code>$ python manage.py createsuperuser
</code></pre>
<p>管理员登陆界面：</p>
<pre><code>http://localhost:8000/admin/
</code></pre>
<p>在admin.py中注册模型，然后就可以在登陆界面管理模型了</p>
<pre><code>from .models import Question
admin.site.register(Question)
</code></pre>
<p>自定义管理表单：</p>
<pre><code>from .models import Question
class QuestionAdmin(admin.ModelAdmin):
    fileds = ['pub_date', 'question_date']
admin.site.register(Question, QuestionAdmin)
</code></pre>
<p>把表单分割成字段集：</p>
<pre><code>from .models import Question
class QuestionAdmin(admin.ModelAdmin):
    fieldsets = [
        (None,               {'fields': ['question_text']}),
        ('Date information', {'fields': ['pub_date']}),
    ]
admin.site.register(Question, QuestionAdmin)
</code></pre>
<h1 id="后台">后台</h1>
<p>django的后台管理程序。</p></p>
                    
                </li>
            
                <li>
                    <h2><a href="https://canuxcheng.com/post/django_view/">View</a></h2>
                    <div class="post-meta">
                        <time>October 4, 2016</time>
                        
                            
                                <span class="category">Django</span>
                            
                        
                    </div>
                    
                        <p><h1 id="viewspy">views.py</h1>
<pre><code>from django.shortcuts import render
</code></pre>
<p>定义自己的视图函数：</p>
<pre><code>from django.http import HttpResponse
from django.template import RequestContext, loader

# 导入模板中的类
from .models import Question

def index(request):
    ...
    t = loader.get_template('application/index.html')
    c = RequestContext(request, {'foo': 'bar'})
    return HttpResponse(t.render(c), content_type=&quot;text/html&quot;)
</code></pre>
<p>当请求一个页面时django会建立一个包含请求元数据的HttpRequest对象，当django加载对应视图时，这个对象作为视图第一个参数。</p>
<p>每个视图会返回一个HttpResponse对象。</p>
<p>每个视图函数都用HttpRequest对象（通常用request）作为第一个参数。</p>
<p>每个视图函数都返回一个HttpResponse对象，包含生成的响应。</p>
<p>HttpRquest和HttpResponse在django.http包中，参考：</p>
<p><a href="http://python.usyiyi.cn/documents/django_182/ref/request-response.html">http://python.usyiyi.cn/documents/django_182/ref/request-response.html</a></p>
<p>HttpRequest对象属性：</p>
<pre><code>request.scheme # http/https
request.body
request.path
request.path_info
request.method # GET/POST
request.encoding
request.user
request.session
request.urlconf
request.GET
request.POST
request.REQUEST
request.COOKIES
request.FILES
request.META
</code></pre>
<p>HttpRequest对象方法：</p>
<pre><code>request.get_host()
...
</code></pre>
<p>HttpResponse对象属性：</p>
<pre><code>response.content
response.charset
response.status_code
response.reason_phrase
response.streaming
response.closed
</code></pre>
<p>HttpResponse对象的方法：</p></p>
                    
                </li>
            
                <li>
                    <h2><a href="https://canuxcheng.com/post/django_url/">URL</a></h2>
                    <div class="post-meta">
                        <time>October 4, 2016</time>
                        
                            
                                <span class="category">Django</span>
                            
                        
                    </div>
                    
                        <p><h1 id="urlspy">urls.py</h1>
<pre><code>from django.urls import path, include
</code></pre>
<p>django请求站点的方法：</p>
<ol>
<li>ROOT_URLCONF，在settings.py中设置。</li>
<li>寻找urlpatterns，它是django.conf.urls.url()实例的一个python列表。</li>
<li>dnango依次匹配每个URL模式，在第一个匹配停下。</li>
<li>一旦一个正则表达式匹配，django就调用对应的视图，视图获得HttpRequest实例,如果是没有命名的组返回内容作为位置参数，如果是命名的组返回内容作为关键字参数。</li>
<li>如果没有匹配到或者过程跑出异常，django调用合适的错误处理。</li>
</ol>
<h1 id="项目的url">项目的URL</h1>
<p>项目的URL主要用来包含应用的URL以及全局的URL:</p>
<pre><code>from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    # 默认的项目的admin的url
    path('admin/', admin.site.urls),
    
    # 在项目URL添加链接到应用URL：
    # 在下面添加你的所有应用的url,
    path('polls/', include('polls.urls')),
]
</code></pre>
<h1 id="应用的url">应用的URL</h1>
<p>将应用的视图映射到URL,需要在应用目录新建urls.py文件,然后在项目的url中包含应用的url。</p>
<p>urlpatterns是url()实例类型的python列表。</p>
<pre><code>from django.urls import path
from . import views

app_name = 'polls'

urlpatterns = [
    # 普通视图
    path('', views.index, name='index'),
    # 类视图
    path('', views.IndexView.as_view(), name='index'),
]
</code></pre>
<hr>
<h1 id="没有命名的组">没有命名的组</h1>
<p>视图函数只有request参数，匹配的正则表达式作为位置参数。</p>
<pre><code>url(r'^pattern1/pattern2/$', views.index, name='index'),

def index(request):
    ...
</code></pre>
<h1 id="命名组">命名组</h1>
<p>视图函数除了request参数还有关键字参数，匹配的命名表达式组作为关键字参数,覆盖默认的关键字参数。</p></p>
                    
                </li>
            
                <li>
                    <h2><a href="https://canuxcheng.com/post/django_model/">Model</a></h2>
                    <div class="post-meta">
                        <time>October 4, 2016</time>
                        
                            
                                <span class="category">Django</span>
                            
                        
                    </div>
                    
                        <p><h1 id="modelspy">models.py</h1>
<pre><code>from django.db import models
</code></pre>
<p>django模型是和数据库关联的，代码放在models.py，数据库信息在settings.py中统一配置即可。</p>
<p>每个模型对应数据库唯一的一张表，是django.db.models.Model的子类。</p>
<p>每个模型实例代表数据库中的一条特定记录.</p>
<p>模型的每个属性都表示为数据库中的一个字段。</p>
<ul>
<li>
<p>在项目的settings.py中激活应用，并设置数据库相关参数。</p>
</li>
<li>
<p>让django包含你的应用：</p>
<p>告诉django你对模型做了更改，并且将这些更改存储为迁移文件polls/migrations/0001_initial.py:</p>
<pre><code>  $python manage.py makemigrations polls
</code></pre>
<p>可以查看迁移文件执行了哪些sql语句,并不真的在数据库执行：</p>
<pre><code>  $python manage.py sqlmigrate polls 0001
</code></pre>
<p>可以检查项目中的模型是否存在问题：</p>
<pre><code>  $python manage.py check
</code></pre>
<p>在数据库中创建模型,查找还没有被应用的迁移文件然后和数据库同步：</p>
<pre><code>  $python manage.py migrate
</code></pre>
</li>
</ul>
<hr>
<h1 id="模型的字段类型和字段选项">模型的字段类型和字段选项</h1>
<p>模型的每个属性都表示为数据库的一个字段,是Field子类的某个实例。</p>
<p>模型的字段还有一些选项。</p>
<p>字段命名规则：</p>
<ol>
<li>不能是python的保留关键字。</li>
<li>字段名中连续的下划线不能超过一个。</li>
</ol>
<p>访问其它应用的模型,导入即可：</p>
<pre><code>from &lt;other-aplication&gt;.models import &lt;module-name&gt;
</code></pre>
<p>模型字段类型和选项参考：</p>
<p><a href="http://python.usyiyi.cn/documents/django_182/ref/models/fields.html#common-model-field-options">http://python.usyiyi.cn/documents/django_182/ref/models/fields.html#common-model-field-options</a></p>
<h2 id="模型字段类型">模型字段类型</h2>
<p>字段的类型都是Field类的子类：</p>
<p>每个字段都接受一个可选的位置参数(一般是第一个），叫字段的自述名,如果不指定就默认是字段名字（下划线换成空格）。</p>
<p>自增字段:</p>
<pre><code>AutoField
# 默认django会每个模型添加一个自增主键字段,如果你显示设置一个自增主键字段就不会默认再添加,每个模型只能有一个主键字段。
# id = models.AutoField(primary_key=True)
</code></pre>
<p>普通字段:</p>
<pre><code>BigIntegerField
BinaryField
BooleanField
CharField
CommaSeparatedIntegerField
DateField
DateTimeField
DecimalField
DurationField
EmailField
FileField
FilePathField
FloatField
GenericIPAddressField
IPAddressField
ImageField
IntegerField
NullBooleanField
PositiveIntegerField
PositiveSmallIntegerField
SlugField
SmallIntegerField
TextField
TimeField
URLField
UUIDField
</code></pre>
<p>关系字段:</p></p>
                    
                </li>
            
                <li>
                    <h2><a href="https://canuxcheng.com/post/django_template/">Template</a></h2>
                    <div class="post-meta">
                        <time>October 4, 2016</time>
                        
                            
                                <span class="category">Django</span>
                            
                        
                    </div>
                    
                        <p><h1 id="模板设置">模板设置</h1>
<p>模板引擎在settings.py设置, django有两套模板引擎：</p>
<pre><code>TEMPLATES = [
    # DjangoTemplates
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        # 定义项目的通用模板, mysite/templates
        'DIRS': [os.path.join(BASE_DIR, 'templates')],
        # True 表示在所有安装应用的application/templates中查找。
        'APP_DIRS': True,
        # 模板的选项：
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ]
        },
    },

    # Jinja2
    {
        'BACKEND': 'django.template.backends.jinja2.Jinja2',
        # 定义项目的通用模板, mysite/templates
        'DIRS': [os.path.join(BASE_DIR, 'templates')],
        # True表示在所有已安装应用的application/jinja2中查找。
        'APP_DIRS': True,
        # 模板的选项：
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ]
        },
    },
]
</code></pre>
<p>BACKEND定义模板引擎,django内置的模板引擎有两个django.template.backends.django.DjangoTemplates(默认)和django.template.backends.jinja2.Jinja2</p>
<p>DIRS存放自定义的不在应用路径的模板，模板引擎按列表顺序搜索查找模板源文件,默认就是默认引擎的默认路径。</p>
<p>APP_DIRS告诉模板引擎是否进入安装应用的templates(jinja2的目录是jinja2)查找模板。</p>
<p>在视图中使用模板：</p>
<p>默认django会在项目的所有应用的templates中查找模板，所以为了防止多个应用有同名的模板，需要在templates下新建application同名的目录来存放模板</p></p>
                    
                </li>
            
        </ul>
    </section>
    
    
        <a href="/page/32/">← Previous</a>
    
    
        <a href="/page/34/">Next →</a>
    
</div>

        </main>
    </div>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 Morgoth. Designed by Canux</p>
        </div>
    </footer>
</body>
</html>
