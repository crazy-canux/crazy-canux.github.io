<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Windows on Canux&#39;s Blog</title>
    <link>http://canuxcheng.com/windows/</link>
    <description>Recent content in Windows on Canux&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    
	<atom:link href="http://canuxcheng.com/windows/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/ps/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/ps/</guid>
      <description>Title: PowerShell Date: 2016-04-26 09:52:02 Tags: PowerShell
PowerShell Console: command line interface
ISE: script editor and console combination
Version:
2.0,3.0,4.0,5.0
C:\Windows\System32\powershell 存放64位powershell
C:\Windows\SysWOW64\powershell 存放32位powershell
1 2  &amp;gt;$PSVersionTable &amp;gt;$HOST   Install/Update:
https://www.microsoft.com/zh-CN/download/details.aspx?id=40855
安装Windows Management Framework4.0即可。
1  &amp;gt;$PSHOME   多版本时切换版本:
1  &amp;gt;powershell -version 2   powershell相关项目 https://github.com/Microsoft
https://github.com/PowerShell
https://github.com/PowerShellOrg
win32-openssh windows的SSH。
https://github.com/PowerShell/Win32-OpenSSH
powershell命令 1 2 3  &amp;gt;powershell -? &amp;gt;powershell /? &amp;gt;powershell -help   powershell script powershell是默认大小写不敏感的。</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/ps_builtins/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/ps_builtins/</guid>
      <description>Title: PowerShell Builtin Command Date: 2016-05-24 10:44:44 Tags: PowerShell, Builtins
Get-Help和Help: get-help查看帮助信息,help分页查看帮助信息，man是help的别名
命令说明：
1 2  Get-Help Help   查看所有命令和概念：
1 2  Get-Help * Help *   模糊查找命令和概念：
1 2  Get-Help *&amp;lt;name&amp;gt;* Help *&amp;lt;name&amp;gt;*   查看具体命令帮助：
1 2 3  Get-Help {&amp;lt;CmdletName&amp;gt; | &amp;lt;TopicName&amp;gt;} Help {&amp;lt;CmdletName&amp;gt; | &amp;lt;TopicName&amp;gt;} &amp;lt;CmdletName&amp;gt; -?   get-help/help的选项:
1 2 3 4 5 6 7  get-help get-help -examples # 查看示例 -full # 查看所有帮助 -parameter # 查看选项的帮助 -detailed # 查看详细信息 -online # 打开文档中的link -showwindow # 用窗口打开   Helpfile 3.</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/ps_coreutils/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/ps_coreutils/</guid>
      <description>Title: PowerShell Coreutils Command Date: 2016-07-12 17:24:25 Tags: PowerShell, Coreutils
外部命令 powershell可以执行外部命令.
1  C:\Windows\System32\*.exe   cmd ping netstat ipconfig route arp nslookup ftp mstsc RDP client.
taskmgr 任务管理器．
tskill tree whoami 需要下载，然后放入环境变量的第三方命令.
WinDump Windows版本的tcpdump, 依赖WinPcap包．
通过windump导出的*.pcap文件可以通过wireshark打开．</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/ps_remote/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/ps_remote/</guid>
      <description>Title: PowerShell RemoteManagement Date: 2016-07-18 14:54:39 Tags: PowerShell, RemoteManagement
Windows远程管理  WinRM, 远程处理,在远程机器上执行命令 WMI/CIM RPC, 远程连接,在发起远程连接的机器上执行命令  WinRM 一对一远程处理:
类似于linux的ssh。
1 2 3  Enter-PSSession -ComputerName name ... Exit-PSSession   一对多远程处理:
同时远程到多台机器执行命令或脚本。
Invoke-Command一次创建一个连接对象，返回PSComputerName属性，执行完后就关闭连接。
1 2 3 4 5  Invoke-Command -ComputerName name1,name2 -ScriptBlock {command1;command2} Invoke-Command -ComputerName name1,name2 -FilePath filepath Invoke-Command -ComputerName (Get-Content hosts.txt) ...   通过argumentlist把本地的参数传给远程的命令:
1 2 3 4 5 6 7 8  $lvar1=&amp;#34;value1&amp;#34; $lvar2=&amp;#34;value2&amp;#34; Invoke-Command -ComputerName name -ScriptBlock { Param($var1, $var2) .</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/ps_utils/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/ps_utils/</guid>
      <description>Title: PowerShell Date: 2016-04-26 09:52:02 Tags: PowerShell
windows相关项目： choco https://github.com/chocolatey
windows的apt/yum。
choco is replacement of chocolatey
1  choco install openssh   cmder cmd的升级版。
https://github.com/cmderdev/cmder
babun a linux-shell like on windows.
https://github.com/babun/babun
flinux run unmodified linux applications inside windows
https://github.com/wishstudio/flinux</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/win/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/win/</guid>
      <description>Title: Windows Date: 2016-04-03 14:15:40 Tags:
windows的IDE VS Enterprise: 收费企业版 VS Professional: 收费个人版 VS Community: 免费社区版
windows的引导程序是ntloader。
DOS和NT是windows系统的内核。
BIOS和MBR基本输入输出系统和主引导记录。
UEFI和GPT是统一的可扩展接口和GUID分区表。
FAT是msdos的文件系统
NTFS是msnt的文件系统
AD AD: Active Directory
管理工具：LDAPSoft AD Browser</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/win_admin/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/win_admin/</guid>
      <description>Title: Admin Date: 2016-04-26 09:54:45 Tags: Windows, Admin</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/win_filesystem/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/win_filesystem/</guid>
      <description>Title: Windows FileSystem Date: 2016-04-03 14:15:40 Tags: Windows, FileSystem</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/win_monitoring/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/win_monitoring/</guid>
      <description>Title: Windows Monitroing Date: 2016-04-03 14:15:40 Tags: Windows, Monitoring
windows的services和process services是windows的服务，有Name(Display Name)，Service Name，Description等属性。
process是以.exe为后缀的application，有Name(product name)、original filename(Image Name)、file description(description)等属性。</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/win_wmi/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/win_wmi/</guid>
      <description>Title: WMI Date: 2016-04-03 14:15:47 Tags: Windows, WMI, CIM
WMI/CIM WMI: windows management instrumentation.
https://msdn.microsoft.com/en-us/library/aa394582(v=vs.85).aspx
CIM: common information model.
https://msdn.microsoft.com/en-us/library/aa389234(v=vs.85).aspx
DCOM: distributed COM.
wmi通过DCOM远程连接，但是DCOM不能绕过防火墙。
命名空间:
1 2 3  root\cimv2 root\microsoftdns root\securitycenter   WMI工具： 1. windows自带wmi测试工具wbemtest. 2. WMI Explorer用于查找wmi和cim的Class和Properties.
http://www.ks-soft.net/hostmon.eng/wmi/index.htm#SysReq
windows怎样设置wmi：
135 (Microsoft RPC), 137-139 (NetBIOS) and 445 (Microsoft DS). These are TCP ports.
设置的用户需要是管理员组。
https://technet.microsoft.com/en-us/library/cc771551(v=ws.11).aspx
给wmi设置fix port(server in DMZ)：
使用过程中不需要指定端口。
https://msdn.microsoft.com/zh-cn/library/bb219447(v=vs.85).aspx
wmic wmic是wmi的客户端命令。
windows的wmic：
1 2 3 4 5  &amp;gt;wmic # 进入wmi的交互模式 &amp;gt;wmic -?</description>
    </item>
    
    <item>
      <title></title>
      <link>http://canuxcheng.com/windows/win_winrm/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://canuxcheng.com/windows/win_winrm/</guid>
      <description>Title: WinRM Date: 2016-07-17 08:36:36 Tags: Windows, WinRM
WinRM Windows Remote Management
WinRM是WSMAN(WS-Management Protocol)的增强版。
WinRM是基于SOAP的防火墙友好的远程协议。
https://msdn.microsoft.com/en-us/library/aa384426(v=vs.85).aspx
WinRM设置:
https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx
检查winrm所有配置：
1  cmd&amp;gt; winrm get winrm/config   快速设置winrm：
1 2  cmd&amp;gt; winrm quickconfig cmd&amp;gt; winrm quickconfig -transport:https   查看listener配置：
1  cmd&amp;gt; winrm enumerate winrm/config/listener   WinRM配置包括监听设置,协议设置,Client,Service和Winrs四部分.
windows的三种网络安全协议。
Basic是基本的明文协议, NTLM是早期的安全协议,Kerberos是最新的安全协议.
service权限管理 查看service的auth配置：
1  cmd&amp;gt; winrm get winrm/config/service/auth   service只有Negotiate和Kerberos是默认开启的:
1 2 3 4 5  Basic = false Kerberos = true Negotiate = true Certificate = false CredSSP = false   Negotiate对domain用户选择kerberos,对local用户选择NTLM.</description>
    </item>
    
  </channel>
</rss>